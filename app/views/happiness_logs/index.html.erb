<%= render 'happiness_logs/index_navigation' %>

<%= render 'happiness_logs/foreground' %>

<%= render 'happiness_logs/index_charts' %>

<%= render 'happiness_logs/demographics' %>

<script type="text/javascript">
  var currentPos = 0;
  var bird1 = document.getElementById("smileybird1");
  var bird2 = document.getElementById("smileybird2");
  var bird3 = document.getElementById("smileybird3");  
  var bodWidth = screen.availWidth;
  var birdPos = -215;

  function move() {
    if (currentPos < (bodWidth + 500)) {
      currentPos = parseInt(bird1.style.right ?
                   bird1.style.right : birdPos) + 10;
      bird1.style.right = currentPos + "px";
      setTimeout("move()", 30);
    }
    if (currentPos < (bodWidth + 500)) {
      currentPos = parseInt(bird2.style.right ?
                   bird2.style.right : birdPos) + 8;
      bird2.style.right = currentPos + "px";
    }
    if (currentPos < (bodWidth + 500)) {
      currentPos = parseInt(bird3.style.right ?
                   bird3.style.right : birdPos) + 8;
      bird3.style.right = currentPos + "px";
    }
  }

  move();
</script>

<script type="text/javascript">
google.load('visualization', '1', {'packages': ['geochart']});
google.setOnLoadCallback(drawMarkersMap);

function drawMarkersMap() {
var happiness_logs = gon.happiness_logs;
var data = google.visualization.arrayToDataTable([['Location']]);
data.addColumn('number', 'Happy Scale');   

happiness_logs.forEach( function (arrayItem) {
   data.addRows([
     [arrayItem['address'], arrayItem['happy_scale']]
   ]);
});

var options = {
  region: gon.region,
  displayMode: 'markers',
  colorAxis: {colors: ['blue', 'red']}
};

var chart = new google.visualization.GeoChart(document.getElementById('world_map_div'));
chart.draw(data, options);
};


google.load('visualization', '1', {'packages':['annotatedtimeline']});
google.setOnLoadCallback(drawChart);
function drawChart() {
  var data = new google.visualization.DataTable();
  data.addColumn('datetime', 'Date');
  data.addColumn('number', 'Happiness');

  var date = gon.date;
  var happiness_log = gon.happiness_logs;
  happiness_log.forEach( function (arrayItem) {
    for (var i in date) {
      data.addRows([
       [new Date(Date.parse(date[i])), arrayItem['happy_scale']]
       ]);
    }
  });

  var options = {
    colors: ['#e0440e'],
    displayAnnotations: true,
    max: 10,
    wmode: 'opaque',
    fill: 50,
    thickness: 3,
  };

  var chart = new google.visualization.AnnotatedTimeLine(document.getElementById('world_chart_div'));

  chart.draw(data, options);
}
</script>
